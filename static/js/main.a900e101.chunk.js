(this.webpackJsonptimetrackerclient=this.webpackJsonptimetrackerclient||[]).push([[0],{342:function(e,t,n){e.exports=n(538)},538:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(77),c=n.n(i),o=n(12),l=Object(a.createContext)();var s=n(114),u=n.n(s),d=n(194),m=n(570),b=n(573),f=n(574),k=n(566),v=n(571),g=n(565),p=n(567);var O=function(e){var t=e.callRegisterEndpoint,n=e.active,a=e.changeModalState,i=e.trigger,c=e.password,o=e.passwordOnChangeHandler,l=e.email,s=e.emailOnChangeHandler,u=e.resultMsg;return r.a.createElement(p.a,{trigger:i,centered:!0,open:n},r.a.createElement(p.a.Header,null,"Register"),r.a.createElement(p.a.Content,null,r.a.createElement(k.a,null,r.a.createElement(k.a.Input,{required:!0,label:"Username",placeholder:"Username",onChange:s,value:l}),r.a.createElement(k.a.Input,{required:!0,label:"Password",placeholder:"Password",type:"password",value:c,onChange:o}),function(){if(u.length>=1)return r.a.createElement(m.a,{negative:!0},r.a.createElement(m.a.Header,null,u))}(),r.a.createElement(v.a,{type:"submit",onClick:t},"Submit"),r.a.createElement(v.a,{onClick:a},"Close"))))},E=n(198),I=n.n(E),h="https://newtimetracker-272513.appspot.com";function j(e,t){return I.a.post(h+"/register",{email:e,password:t}).then((function(e){return e.data}))}function C(e,t){return I.a.post(h+"/authenticate",{email:e,password:t}).then((function(e){return e.data}))}var T=function(){var e=Object(a.useContext)(l),t=Object(a.useState)(!1),n=Object(o.a)(t,2),i=n[0],c=n[1],s=Object(a.useState)(""),p=Object(o.a)(s,2),E=p[0],I=p[1],h=Object(a.useState)(""),T=Object(o.a)(h,2),y=T[0],S=T[1],w=Object(a.useState)(""),x=Object(o.a)(w,2),A=x[0],M=x[1],D=Object(a.useState)(!1),$=Object(o.a)(D,2),N=$[0],R=$[1],L=function(e){var t=e.target.value;I(t)},q=function(e){var t=e.target.value;S(t)},_=function(){var e=Object(d.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==E&&""!==y){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,j(E,y);case 5:t=e.sent,e.next=13;break;case 8:e.prev=8,e.t0=e.catch(2),R(!1),n=e.t0.response?e.t0.response.data.message:"Unable to reach server",M(n);case 13:t&&(R(!0),M("Registration successful"),P());case 14:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(){return e.apply(this,arguments)}}(),B=function(){var t=Object(d.a)(u.a.mark((function t(){var n,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==E&&""!==y){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,C(E,y);case 5:a=t.sent,t.next=13;break;case 8:t.prev=8,t.t0=t.catch(2),R(!1),n=t.t0.response?t.t0.response.data.message:"Unable to reach server",M(n);case 13:a&&(e.updateUserAndLocalStorage(a),e.setAuthenticated(!0),M(""));case 14:case"end":return t.stop()}}),t,null,[[2,8]])})));return function(){return t.apply(this,arguments)}}(),P=function(){c(!i)};return r.a.createElement("div",{className:"loginDiv"},r.a.createElement(b.a,{placeholder:!0,className:"loginSegment"},r.a.createElement(f.a,{columns:2,relaxed:"very",stackable:!0},r.a.createElement(f.a.Column,{className:"loginGridColumn"},r.a.createElement(k.a,null,r.a.createElement(k.a.Input,{icon:"user",iconPosition:"left",label:"Username",placeholder:"Username",value:E,onChange:L}),r.a.createElement(k.a.Input,{icon:"lock",iconPosition:"left",label:"Password",type:"password",placeholder:"Password",value:y,onChange:q}),r.a.createElement(v.a,{content:"Login",primary:!0,onClick:B}))),r.a.createElement(f.a.Column,{verticalAlign:"middle",className:"loginGridColumn"},r.a.createElement(O,{"data-testid":"registerModal",trigger:r.a.createElement(v.a,{content:"Sign up",icon:"signup",size:"big",onClick:P}),active:i,callRegisterEndpoint:_,password:y,passwordOnChangeHandler:q,email:E,emailOnChangeHandler:L,resultMsg:A,changeModalState:P}))),r.a.createElement(g.a,{vertical:!0},"Or"),function(){if(A.length>=1)return N?r.a.createElement(m.a,{positive:!0},r.a.createElement(m.a.Header,null,A)):r.a.createElement(m.a,{negative:!0},r.a.createElement(m.a.Header,null,A))}()))},y=n(26),S=n(39),w=n(99);function x(){var e=Object(S.a)(["\n    query getAllTimeCommits($ownerId: ID!, $subtaskId: ID!) {\n        getAllTimeCommits(ownerId: $ownerId, subtaskId: $subtaskId) {\n           id\n           date\n           time\n        }\n    }\n    "]);return x=function(){return e},e}function A(){var e=Object(S.a)(["\n    query getAllSubtasks($ownerId: ID!, $taskId: ID!) {\n        getAllSubtasks(ownerId: $ownerId, taskId: $taskId) {\n           id\n           timeCommits {\n               id\n               date\n               time\n           }\n        }\n    }\n    "]);return A=function(){return e},e}function M(){var e=Object(S.a)(["\n    query getTask($ownerId: ID!, $taskId: ID!) {\n        getTask(ownerId: $ownerId, taskId: $taskId) {\n           id\n           taskName\n           totalTime\n        }\n    }\n    "]);return M=function(){return e},e}function D(){var e=Object(S.a)(["\n    query getAllTasks($ownerId: ID!) {\n        getAllTasks(ownerId: $ownerId) {\n            id\n            taskName\n            totalTime\n            completed\n            subtasks {\n              id\n              subtaskName\n              category\n              totalTime\n              dependsOn {\n                 id   \n               }\n            }\n            client {\n               id\n            }\n        }\n    }\n    "]);return D=function(){return e},e}function $(){var e=Object(S.a)(["\n    query getAllClients($ownerId: ID!) {\n        getAllClients(ownerId: $ownerId) {\n           id\n           clientName\n           businessType\n           location\n        }\n    }\n    "]);return $=function(){return e},e}var N={ALL_CLIENTS:Object(w.a)($()),ALL_TASKS:Object(w.a)(D()),GET_TASK:Object(w.a)(M()),ALL_SUBTASKS:Object(w.a)(A()),ALL_TIMECOMMITS:Object(w.a)(x())},R=n(52),L=n.n(R);function q(){var e=Object(S.a)(["\n    mutation updateTimeCommit($ownerId: ID!, $timeCommitId: ID!, $time: Long!){\n      updateTimeCommit(ownerId: $ownerId, timeCommitId: $timeCommitId, time: $time) {\n        id\n      }\n    }\n    "]);return q=function(){return e},e}function _(){var e=Object(S.a)(["\n    mutation createOrUpdateTimeCommit($ownerId: ID!, $subtaskId: ID!, $time: Long!){\n      createOrUpdateTimeCommit(ownerId: $ownerId, subtaskId: $subtaskId, time: $time) {\n        id\n        ownerId\n        time\n      }\n    }\n    "]);return _=function(){return e},e}function B(){var e=Object(S.a)(["\n    mutation deleteSubtask($ownerId: ID!, $subtaskId: ID!){\n      deleteSubtask(ownerId: $ownerId, subtaskId: $subtaskId) \n    }\n    "]);return B=function(){return e},e}function P(){var e=Object(S.a)(["\n    mutation createSubtask($ownerId: ID!, $taskId: ID!, $subtaskName: String!, $category: String!, $dependsOnIds: [ID]!) {\n      createSubtask(ownerId: $ownerId, taskId: $taskId, subtaskName: $subtaskName, category: $category, dependsOnIds: $dependsOnIds) {\n             id\n             dependsOn {\n                 id\n             }\n        }\n    }\n    "]);return P=function(){return e},e}function U(){var e=Object(S.a)(["\n    mutation deleteTask($ownerId: ID!, $taskId: ID!){\n      deleteTask(ownerId: $ownerId, taskId: $taskId) \n    }\n    "]);return U=function(){return e},e}function W(){var e=Object(S.a)(["\n    mutation createTask($ownerId: ID!, $taskName: String!, $clientId: ID!) {\n      createTask(ownerId: $ownerId, taskName: $taskName, clientId: $clientId) {\n        id\n        taskName\n        client {\n          id\n          clientName\n        }\n      }\n    }\n    "]);return W=function(){return e},e}function H(){var e=Object(S.a)(["\n    mutation deleteClient($ownerId: ID!, $clientId: ID!){\n      deleteClient(ownerId: $ownerId, clientId: $clientId) \n    }\n    "]);return H=function(){return e},e}function z(){var e=Object(S.a)(["\n    mutation createClient($ownerId: ID!, $clientName: String!, $businessType: String!, $location: String!){\n        createClient(ownerId: $ownerId, clientName: $clientName, businessType: $businessType, location: $location) {\n          id\n          clientName\n          businessType\n          location\n        }\n      }\n    "]);return z=function(){return e},e}var K={CREATE_CLIENT:L()(z()),DELETE_CLIENT:L()(H()),CREATE_TASK:L()(W()),DELETE_TASK:L()(U()),CREATE_SUBTASK:L()(P()),DELETE_SUBTASK:L()(B()),CREATE_OR_UPDATE_TIMECOMMIT:L()(_()),UPDATE_TIMECOMMIT:L()(q())},X=function(e){return new Promise((function(t){return setTimeout(t,e)}))},Y=Object(a.createContext)();var G=n(303),F=function(e,t){return{source:e,target:t,distance:120}},J=function(e,t,n,a){var r=e/t;return Math.min(Math.max(r,n),a)},Q=Object(a.createContext)();var V=function(e,t){return e.sort((function(e,n){return e[t].localeCompare(n[t])})).map((function(e,n){return{key:n,text:e[t],value:e.id}}))},Z=function(e){return function(t,n,a){return function(r,i){return e(t,n,a,r,i)}}},ee=function(e,t,n,a){a&&(t({variables:{ownerId:n,clientId:a}}),e(null))},te=function(e,t,n,a){a&&(t({variables:{ownerId:n,taskId:a}}),e(null))},ne=function(e,t,n,a,r){a&&(t({variables:{ownerId:n,subtaskId:a}}).then((function(){r()})),e(null))},ae=n(569);var re=function(e){var t=e.onClose,n=Object(a.useContext)(l),i=Object(a.useState)(""),c=Object(o.a)(i,2),s=c[0],u=c[1],d=Object(a.useState)(""),m=Object(o.a)(d,2),b=m[0],f=m[1],g=Object(a.useState)(""),p=Object(o.a)(g,2),O=p[0],E=p[1],I=Object(y.b)(K.CREATE_CLIENT),h=Object(o.a)(I,1)[0];return r.a.createElement(k.a,null,r.a.createElement(k.a.Input,{required:!0,label:"Client name",placeholder:"Client name",onChange:function(e){var t=e.target.value;u(t)},value:s}),r.a.createElement(k.a.Input,{required:!0,label:"Business Type",placeholder:"Business type",onChange:function(e){var t=e.target.value;f(t)},value:b}),r.a.createElement(k.a.Input,{required:!0,label:"Location",placeholder:"Location",onChange:function(e){var t=e.target.value;E(t)},value:O}),r.a.createElement(v.a,{type:"submit",onClick:function(){s&&b&&O&&(h({variables:{ownerId:n.user.id,clientName:s,businessType:b,location:O}}),t())}},"Save"),r.a.createElement(v.a,{type:"close",onClick:t},"Close"))};var ie=function(e){var t=e.onClose,n=e.activeClientId,i=Object(a.useContext)(l),c=Object(a.useState)(""),s=Object(o.a)(c,2),u=s[0],d=s[1],m=Object(y.b)(K.CREATE_TASK),b=Object(o.a)(m,1)[0];return r.a.createElement(k.a,null,r.a.createElement(k.a.Input,{required:!0,label:"Task name",placeholder:"Task name",onChange:function(e){var t=e.target.value;d(t)},value:u}),r.a.createElement(v.a,{type:"submit",onClick:function(){u&&(b({variables:{ownerId:i.user.id,taskName:u,clientId:n}}),t())}},"Save"),r.a.createElement(v.a,{type:"close",onClick:t},"Close"))};var ce=function(e){var t=e.onClose,n=e.activeTaskId,i=e.refetch,c=e.subtasks,s=Object(a.useContext)(l),u=Object(a.useState)(""),d=Object(o.a)(u,2),m=d[0],b=d[1],f=Object(a.useState)(""),g=Object(o.a)(f,2),p=g[0],O=g[1],E=Object(a.useState)([]),I=Object(o.a)(E,2),h=I[0],j=I[1],C=Object(y.b)(K.CREATE_SUBTASK,{onCompleted:function(){i()}}),T=Object(o.a)(C,1)[0];return r.a.createElement(k.a,null,r.a.createElement(k.a.Input,{required:!0,label:"Subtask name",placeholder:"Subtask name",onChange:function(e){var t=e.target.value;b(t)},value:m}),r.a.createElement(k.a.Input,{required:!0,label:"Category",placeholder:"Category",onChange:function(e){var t=e.target.value;O(t)},value:p}),r.a.createElement(k.a.Dropdown,{fluid:!0,multiple:!0,selection:!0,required:!0,label:"Depends on",placeholder:"Select tasks",options:c,onClick:function(){return i()},onChange:function(e,t){var n=t.value;j(n)}}),r.a.createElement(v.a,{type:"submit",onClick:function(){m&&p&&(T({variables:{ownerId:s.user.id,taskId:n,subtaskName:m,category:p,dependsOnIds:h}}),t())}},"Save"),r.a.createElement(v.a,{type:"close",onClick:t},"Close"))};var oe=function(e){var t,n=e.items,i=e.refetch,c=e.deleteItem,l=e.itemName,s=e.setActiveItem,u=e.activeClientId,d=e.activeTaskId,m=e.addDisabled,f=e.deleteDisabled,k=e.handleTaskRefetch,g=Object(a.useState)(!1),O=Object(o.a)(g,2),E=O[0],I=O[1],h=Object(a.useState)(null),j=Object(o.a)(h,2),C=j[0],T=j[1],y=function(){return I(!0)},S=function(){return I(!1)},w=function(){C&&(c(C,k),T(null),s(null))};switch(l){case"client":t=r.a.createElement(re,{onClose:S}," ");break;case"task":t=r.a.createElement(ie,{onClose:S,activeClientId:u}," ");break;case"subtask":t=r.a.createElement(ce,{onClose:S,activeTaskId:d,subtasks:n,refetch:i}," ");break;default:t=null}var x=f?r.a.createElement(v.a,{disabled:!0,basic:!0,onClick:w},"Delete ",l):r.a.createElement(v.a,{basic:!0,size:"small",onClick:w},"Delete ",l),A=m?r.a.createElement(v.a,{disabled:!0,basic:!0,onClick:y},"New ",l):r.a.createElement(v.a,{basic:!0,size:"small",onClick:y},"New ",l);return r.a.createElement(b.a.Group,{compact:!0,horizontal:!0},r.a.createElement(b.a,{id:"dropdownContainerLeft",textAlign:"center"},r.a.createElement(ae.a,{search:!0,selection:!0,id:"dropdown",placeholder:"Select ".concat(l),options:n,onClick:function(){return i()},onChange:function(e,t){var n=t.value;T(n),s(n)},value:C})),r.a.createElement(b.a,{textAlign:"center"},x),r.a.createElement(b.a,{textAlign:"center"},r.a.createElement(p.a,{trigger:A,open:E},r.a.createElement(p.a.Header,null,"Add ",l),r.a.createElement(p.a.Content,null,t))))},le=1,se=!1,ue=null,de=function(e,t,n){if(n&&e>=86400)return"24:00:00";var a=e/3600,r=e%3600,i=r/60,c=r%60,o=a<10?"0":"",l=i<10?"0":"",s=c<10?"0":"";return t?"".concat(o).concat(Math.floor(a),":").concat(l).concat(Math.floor(i)):"".concat(o).concat(Math.floor(a),":").concat(l).concat(Math.floor(i),":").concat(s).concat(c)},me=n(572);var be=function(e){var t,n=e.activeTask,a=e.activeTaskId,i=e.tasks;return!n&&a&&i?t=i.filter((function(e){return Number(e.id)===Number(a)}))[0]:n&&(t=n),r.a.createElement(b.a,{id:"totalTimeDisplay"},function(){if(t){var e=t,n=e.taskName,a=e.totalTime;return r.a.createElement(me.a,{label:n,value:de(a,!1,!1)})}return r.a.createElement(me.a,{label:"Select a task",value:"00:00:00"})}())};var fe=function(){var e=Object(a.useContext)(l).user.id,t=Object(a.useContext)(Q),n=t.activeSubtaskId,i=t.activeTaskId,c=t.tasks,s=t.activeTask,u=t.setActiveTask,d=Object(a.useContext)(Y).getTask,k=Object(a.useState)(0),g=Object(o.a)(k,2),p=g[0],O=g[1],E=Object(a.useState)(!1),I=Object(o.a)(E,2),h=I[0],j=I[1],C=Object(a.useState)(!1),T=Object(o.a)(C,2),S=T[0],w=T[1],x=Object(y.b)(K.CREATE_OR_UPDATE_TIMECOMMIT,{onCompleted:function(){return d({variables:{ownerId:e,taskId:i},onCompleted:function(e){u(e.getTask)}})}}),A=Object(o.a)(x,1)[0],M=function(){!function(e){clearInterval(ue),e(0),se=!1;var t=le;le=1}(O)},D=function(){j(!0),setTimeout((function(){j(!1)}),1e3)};return r.a.createElement(b.a.Group,{id:"timerBox"},r.a.createElement(be,{activeTask:s,activeTaskId:i,tasks:c}),r.a.createElement(b.a,null,r.a.createElement(f.a,{columns:2,stackable:!0,textAlign:"center"},r.a.createElement(f.a.Column,{id:"timerCol"},r.a.createElement("div",{className:"counterWrapper"},r.a.createElement("button",{className:"timerButton",onClick:function(){n?function(e){se?(clearInterval(ue),se=!1):(ue=setInterval((function(){e(le++)}),1e3),se=!0)}(O):(w("Please select a subtask"),D())}},de(p,!1,!0)))),r.a.createElement(f.a.Column,{id:"timerCol"},r.a.createElement(v.a.Group,{id:"timerButtons"},r.a.createElement(v.a,{size:"huge",basic:!0,color:"green",onClick:function(){p>0&&n?(A({variables:{ownerId:e,subtaskId:n,time:p}}),M()):(w(0===p?"Please start the timer before saving":"Please select a subtask"),D())}},"Save"),r.a.createElement(v.a,{size:"huge",basic:!0,color:"green",onClick:M},"Reset")))),function(){if(h)return r.a.createElement(m.a,{negative:!0,id:"selectSubtaskPrompt"},r.a.createElement(m.a.Header,null,S))}()))};var ke=function(e){var t=e.userId,n=Object(a.useContext)(Y),i=n.getTask,c=n.deleteClient,l=n.deleteTask,s=n.deleteSubtask,u=Object(a.useContext)(Q),d=u.setTasks,m=u.activeTaskId,f=u.setActiveTaskId,k=u.activeTask,v=u.setActiveTask,g=u.activeSubtaskId,p=u.setActiveSubtaskId,O=Object(a.useState)(null),E=Object(o.a)(O,2),I=E[0],h=E[1],j=Z(ee),C=Z(te),T=Z(ne),S=Object(y.c)(N.ALL_CLIENTS,{variables:{ownerId:t}}),w=S.loading,x=S.error,A=S.data,M=S.refetch,D=Object(y.c)(N.ALL_TASKS,{variables:{ownerId:t}}),$=D.loading,R=D.error,L=D.data,q=D.refetch;if(w||$)return null;(x||R)&&(x?console.error(x):console.error(R));var _=function(e){return V(e,"clientName")}(A.getAllClients);d(L.getAllTasks);var B=function(e,t){return V(e.filter((function(e){return e.client.id===t})),"taskName")}(L.getAllTasks,I),P=function(e,t,n){var a=e.filter((function(e){return e.client.id===t&&e.id===n})).flatMap((function(e){return e.subtasks}));return V(a,"subtaskName")}(L.getAllTasks,I,m),U=function(){q(),f(m),d(L.getAllTasks),m&&i({variables:{ownerId:t,taskId:m},onCompleted:function(e){v(e.getTask)}})};return r.a.createElement(b.a.Group,{size:"small",compact:!0,horizontal:!0,id:"topSegment"},r.a.createElement(b.a,{size:"small",id:"selectionBox"},r.a.createElement(oe,{refetch:M,items:_,deleteItem:j(h,c,t),itemName:"client",setActiveItem:function(e){h(e),f(null),d(null),p(null)},deleteDisabled:!Boolean(I),addDisabled:!1}),r.a.createElement(oe,{refetch:U,items:B,deleteItem:C(f,l,t),itemName:"task",setActiveItem:function(e){f(e),p(null)},activeClientId:I,addDisabled:!Boolean(I),deleteDisabled:!Boolean(m)}),r.a.createElement(oe,{refetch:U,items:P,deleteItem:T(p,s,t),handleTaskRefetch:U,itemName:"subtask",setActiveItem:p,activeTaskId:m,addDisabled:!Boolean(m),deleteDisabled:!Boolean(g)})),r.a.createElement(b.a,null,r.a.createElement(fe,{getTask:i,activeTask:k})))},ve=n(41),ge=n(28),pe=n(59),Oe=n(89),Ee=n(25),Ie=n.n(Ee),he=n(56),je=n.n(he),Ce=n(150),Te=n.n(Ce),ye=n(119),Se=function(e){var t=e.nodes,n=e.links,r=e.linkDistance,i=e.repulsivity,c=e.distanceMin,l=e.distanceMax,s=e.center,u=e.iterations,d=Object(a.useState)([]),m=Object(o.a)(d,2),b=m[0],f=m[1],k=Object(a.useState)([]),v=Object(o.a)(k,2),g=v[0],p=v[1];return Object(a.useEffect)((function(){var e=function(e){var t,n=e.linkDistance,a=e.repulsivity,r=e.distanceMin,i=e.distanceMax,c=e.center;return"function"===typeof n||Te()(n)?t=n:je()(n)&&(t=function(e){return Ie()(e,n)}),{link:Object(ye.b)().id((function(e){return e.id})).distance(t),charge:Object(ye.c)().strength(-a).distanceMin(r).distanceMax(i),center:Object(ye.a)(c[0],c[1])}}({linkDistance:r,repulsivity:i,distanceMin:c,distanceMax:l,center:s}),a=t.map((function(e){return Object(ve.a)({},e)})),o=n.map((function(e){return Object(ve.a)({id:"".concat(e.source,".").concat(e.target)},e)})),d=Object(ye.d)(a).force("link",e.link.links(o)).force("charge",e.charge).force("center",e.center).stop();return d.tick(u),f(a),p(o.map((function(e){return e.previousSource=b.find((function(t){return t.id===e.source.id})),e.previousTarget=b.find((function(t){return t.id===e.target.id})),e}))),function(){d.stop()}}),[t,n,r,i,c,l,u,s[0],s[1]]),[b,g]},we=function(e){return Object(a.useMemo)((function(){return"function"===typeof e?e:function(){return e}}),[e])},xe=function(e){return Object(a.useMemo)((function(){return"function"===typeof e?e:function(){return e}}),[e])},Ae=n(23);var Me=function(e){var t=e.handleSliderChange,n=e.min,a=e.max,i=e.value;return r.a.createElement("div",{className:"sliderContainer"},r.a.createElement("input",{onInput:t,type:"range",min:n,max:a,value:i,className:"slider",id:"myRange"}))};var De=function(e){var t=e.date,n=e.time,i=e.timeCommitId,c=e.displayTime,s=e.setMessage,u=e.getTimecommits,d=Object(a.useContext)(l).user.id,m=Object(a.useContext)(Q),f=m.activeTaskId,k=m.setActiveTask,g=Object(a.useContext)(Y).getTask,p=Object(y.b)(K.UPDATE_TIMECOMMIT,{onCompleted:function(){s(!0,"Update successful"),g({variables:{ownerId:d,taskId:f},onCompleted:function(e){k(e.getTask)}}),u()},onError:function(e){s(!1,"Update failed")}}),O=Object(o.a)(p,1)[0];return r.a.createElement(b.a.Group,{horizontal:!0},r.a.createElement(b.a,{textAlign:"center",size:"large"},new Date(t).toDateString()),r.a.createElement(b.a,{textAlign:"center",size:"large"},c),r.a.createElement(b.a,{textAlign:"center"},r.a.createElement(v.a,{size:"medium",onClick:function(){O&&O({variables:{ownerId:d,timeCommitId:i,time:Number(n)}})}},"Update")))};var $e=function(e){var t,n,i=e.timeCommit,c=e.setMessage,l=e.getTimecommits,s=function(e){return 300*e},u=i.id,d=i.time,m=i.date,f=Object(a.useState)((t=d,Math.round(t/300))),k=Object(o.a)(f,2),v=k[0],g=k[1];return r.a.createElement(b.a.Group,null,r.a.createElement(b.a,null,r.a.createElement(Me,{handleSliderChange:function(e){var t=e.target.value;g(t)},min:0,max:288,value:v})),r.a.createElement(De,{date:new Date(m).toDateString(),displayTime:(n=v,de(s(n),!0,!0)),timeCommitId:Number(u),time:s(v),setMessage:c,getTimecommits:l}))};var Ne=function(e){var t=e.handleClose,n=e.isOpen,i=e.timeCommits,c=e.name,l=e.totalTime,s=e.getTimecommits,u=Object(a.useState)(""),d=Object(o.a)(u,2),b=d[0],f=d[1],k=Object(a.useState)(!0),g=Object(o.a)(k,2),O=g[0],E=g[1],I=function(e,t){e||E(!1),f(t),X(1e3).then((function(){E(!0),f("")}))};return r.a.createElement(p.a,{open:n},r.a.createElement(p.a.Header,{className:"nodeModalHeader"},r.a.createElement(me.a,{label:c,value:l})),r.a.createElement(p.a.Content,{scrolling:!0},i.map((function(e,t){return r.a.createElement("div",{key:t},r.a.createElement($e,{timeCommit:e,setMessage:I,getTimecommits:s}))}))),r.a.createElement(p.a.Actions,null,r.a.createElement(v.a,{onClick:t},"Close")),b&&O?r.a.createElement(m.a,{positive:!0},b):b&&!O?r.a.createElement(m.a,{negative:!0},b):void 0)},Re=Object(a.memo)((function(e){var t=e.x,n=e.y,i=e.radius,c=e.color,s=e.borderWidth,u=e.borderColor,d=e.scale,m=void 0===d?1:d,b=e.node,f=Object(a.useContext)(l).user.id,k=Object(a.useState)(!1),v=Object(o.a)(k,2),g=v[0],p=v[1],O=Object(a.useState)([]),E=Object(o.a)(O,2),I=E[0],h=E[1],j=Object(a.useState)(0),C=Object(o.a)(j,2),T=C[0],S=C[1],w=Object(y.a)(N.ALL_TIMECOMMITS,{variables:{ownerId:f,subtaskId:b.id-1},fetchPolicy:"cache-and-network",onCompleted:function(e){h(e.getAllTimeCommits),S(A(e.getAllTimeCommits)),p(!0)}}),x=Object(o.a)(w,1)[0],A=function(e){return e.length&&e?e.map((function(e){return e.time})).reduce((function(e,t){return e+t})):0};return r.a.createElement(r.a.Fragment,null,r.a.createElement("circle",{onClick:function(){1!==b.id&&x()},transform:"translate(".concat(t,",").concat(n,") scale(").concat(m,")"),r:i,fill:c,strokeWidth:s,stroke:u}),r.a.createElement(Ne,{handleClose:function(){p(!1)},isOpen:g,timeCommits:I,totalTime:de(T,!1,!1),name:b.name,getTimecommits:x}))})),Le=function(e){var t=e.style;return{x:t.x.val,y:t.y.val,radius:t.radius.val,scale:0}},qe=function(e){return function(t){var n=t.style;return{x:n.x,y:n.y,radius:n.radius,scale:Object(Ae.spring)(0,e)}}},_e=Object(a.memo)((function(e){var t=e.nodes,n=e.color,a=e.borderWidth,i=e.borderColor,c=Object(ge.e)().springConfig;return r.a.createElement(Ae.TransitionMotion,{willEnter:Le,willLeave:qe(c),styles:t.map((function(e){return{key:e.id,data:e,style:{x:Object(Ae.spring)(e.x,c),y:Object(Ae.spring)(e.y,c),radius:Object(Ae.spring)(e.radius,c),scale:Object(Ae.spring)(1,c)}}}))},(function(e){return r.a.createElement(r.a.Fragment,null,e.map((function(e){var t=e.key,c=e.style,o=e.data;return r.a.createElement(Re,{key:t,node:o,x:c.x,y:c.y,radius:Math.max(c.radius,0),color:n(o),borderWidth:a,borderColor:i(o),scale:Math.max(c.scale,0)})})))}))})),Be=Object(a.memo)((function(e){var t=e.nodes,n=e.color,a=e.borderWidth,i=e.borderColor;return t.map((function(e){return r.a.createElement(Re,{key:e.id,node:e,x:e.x,y:e.y,radius:e.radius,color:n(e),borderWidth:a,borderColor:i(e)})}))})),Pe=Object(a.memo)((function(e){var t=e.sourceX,n=e.sourceY,a=e.targetX,i=e.targetY,c=e.thickness,o=e.color;return r.a.createElement("line",{stroke:o,strokeWidth:c,strokeLinecap:"round",x1:t,y1:n,x2:a,y2:i})})),Ue=function(e){var t=e.style,n=e.data,a=n.previousSource?n.previousSource.x:t.sourceX.val,r=n.previousSource?n.previousSource.y:t.sourceY.val;return{sourceX:a,sourceY:r,targetX:a,targetY:r}},We=Object(a.memo)((function(e){var t=e.links,n=e.linkThickness,a=e.linkColor,i=Object(ge.e)().springConfig;return r.a.createElement(Ae.TransitionMotion,{willEnter:Ue,styles:t.map((function(e){return{key:e.id,data:e,style:{sourceX:Object(Ae.spring)(e.source.x,i),sourceY:Object(Ae.spring)(e.source.y,i),targetX:Object(Ae.spring)(e.target.x,i),targetY:Object(Ae.spring)(e.target.y,i)}}}))},(function(e){return r.a.createElement(r.a.Fragment,null,e.map((function(e){var t=e.key,i=e.style,c=e.data;return r.a.createElement(Pe,{key:t,link:c,color:a(c),thickness:n(c),sourceX:i.sourceX,sourceY:i.sourceY,targetX:i.targetX,targetY:i.targetY})})))}))})),He=Object(a.memo)((function(e){var t=e.links,n=e.linkThickness,a=e.linkColor;return t.map((function(e){return r.a.createElement(Pe,{key:e.id,link:e,color:a(e),thickness:n(e),sourceX:e.source.x,sourceY:e.source.y,targetX:e.target.x,targetY:e.target.y})}))})),ze=function(e){var t=e.width,n=e.height,i=e.margin,c=e.nodes,l=e.links,s=e.linkDistance,u=e.repulsivity,d=e.distanceMin,m=e.distanceMax,b=e.iterations,f=e.layers,k=e.nodeColor,v=e.nodeBorderWidth,g=e.nodeBorderColor,p=e.linkThickness,O=e.linkColor,E=Object(ge.d)(t,n,i),I=E.margin,h=E.innerWidth,j=E.innerHeight,C=E.outerWidth,T=E.outerHeight,y=Object(ge.e)().animate,S=Object(ge.f)(),w=we(k),x=Object(pe.b)(g,S),A=xe(p),M=Object(pe.b)(O,S),D=Se({nodes:c,links:l,linkDistance:s,repulsivity:u,distanceMin:d,distanceMax:m,iterations:b,center:[h/2,j/2]}),$=Object(o.a)(D,2),N=$[0],R=$[1],L={links:r.a.createElement(!0===y?We:He,{key:"links",links:R,linkThickness:A,linkColor:M}),nodes:r.a.createElement(!0===y?_e:Be,{key:"nodes",nodes:N,color:w,borderWidth:v,borderColor:x})};return r.a.createElement(ge.b,{width:C,height:T,margin:I},f.map((function(t,n){return"function"===typeof t?r.a.createElement(a.Fragment,{key:n},t(Object(ve.a)({},e,{innerWidth:h,innerHeight:j,nodes:N,links:R}))):L[t]})))};ze.defaultProps=Oe.b;var Ke=Object(ge.h)(ze),Xe=function(e){return r.a.createElement(ge.a,null,(function(t){var n=t.width,a=t.height;return r.a.createElement(Ke,Object.assign({width:n,height:a},e))}))},Ye=function(e){var t=e.width,n=e.height,i=e.margin,c=e.pixelRatio,l=e.nodes,s=e.links,u=e.linkDistance,d=e.repulsivity,m=e.distanceMin,b=e.distanceMax,f=e.iterations,k=e.layers,v=e.nodeColor,g=e.nodeBorderWidth,p=e.nodeBorderColor,O=e.linkThickness,E=e.linkColor,I=e.isInteractive,h=Object(a.useRef)(null),j=Object(ge.d)(t,n,i),C=j.margin,T=j.innerWidth,y=j.innerHeight,S=j.outerWidth,w=j.outerHeight,x=Se({nodes:l,links:s,linkDistance:u,repulsivity:d,distanceMin:m,distanceMax:b,iterations:f,center:[T/2,y/2]}),A=Object(o.a)(x,2),M=A[0],D=A[1],$=Object(ge.f)(),N=we(v),R=Object(pe.b)(p,$),L=xe(O),q=Object(pe.b)(E,$);return Object(a.useEffect)((function(){h.current.width=S*c,h.current.height=w*c;var t=h.current.getContext("2d");t.scale(c,c),t.fillStyle=$.background,t.fillRect(0,0,S,w),t.translate(C.left,C.top),k.forEach((function(n){"links"===n?D.forEach((function(e){t.strokeStyle=q(e),t.lineWidth=L(e),t.beginPath(),t.moveTo(e.source.x,e.source.y),t.lineTo(e.target.x,e.target.y),t.stroke()})):"nodes"===n?M.forEach((function(e){t.fillStyle=N(e),t.beginPath(),t.arc(e.x,e.y,e.radius,0,2*Math.PI),t.fill(),g>0&&(t.strokeStyle=R(e),t.lineWidth=g,t.stroke())})):"function"===typeof n&&n(t,Object(ve.a)({},e,{nodes:M,links:D}))}))}),[h,S,w,k,$,M,D,N,g,R,L,q]),r.a.createElement("canvas",{ref:h,width:S*c,height:w*c,style:{width:S,height:w,cursor:I?"auto":"normal"}})};Ye.defaultProps=Oe.a;Object(ge.h)(Ye);var Ge=function(){var e=Object(a.useContext)(Q),t=e.nodes,n=e.links,i=Object(a.useContext)(Y).errorMessage;return function(e,t){return r.a.createElement("div",{id:"graphDiv"},r.a.createElement(Xe,{nodes:e,links:t,margin:{top:0,right:0,bottom:0,left:0},repulsivity:1e3,iterations:60,nodeColor:function(e){return e.color},nodeBorderWidth:1,nodeBorderColor:{from:"color",modifiers:[["darker",.8]]},linkThickness:function(e){return 2*(2-e.source.depth)},motionStiffness:160,motionDamping:12}),function(e){if(e)return r.a.createElement(m.a,{negative:!0},r.a.createElement(m.a.Header,{className:"graphMessage"},e))}(i))}(t,n)};var Fe=function(){var e=Object(a.useContext)(l),t=e.authenticated,n=e.user.id;return t?r.a.createElement("div",null,r.a.createElement(ke,{userId:n}),r.a.createElement(Ge,null)):r.a.createElement(T,null)},Je=n(36),Qe=n(47),Ve=n(76),Ze=n(90),et=n(301),tt=Object(Ze.b)({uri:"https://newtimetracker-272513.appspot.com/graphql"}),nt=Object(et.a)((function(e,t){var n=t.headers,a=localStorage.getItem("token");return{headers:Object(ve.a)({},n,{authorization:a?"Bearer ".concat(a):""})}})),at=new Qe.a({link:nt.concat(tt),cache:new Ve.a});n(537);c.a.render(r.a.createElement(Je.a,{client:at},r.a.createElement((function(e){var t=e.children,n=Object(a.useState)(null),i=Object(o.a)(n,2),c=i[0],l=i[1],s=Object(a.useState)(null),u=Object(o.a)(s,2),d=u[0],m=u[1],b=Object(a.useState)(null),f=Object(o.a)(b,2),k=f[0],v=f[1],g=Object(a.useState)(null),p=Object(o.a)(g,2),O=p[0],E=p[1],I=Object(a.useState)([]),h=Object(o.a)(I,2),j=h[0],C=h[1],T=Object(a.useState)([]),y=Object(o.a)(T,2),S=y[0],w=y[1];return Object(a.useEffect)((function(){if(null===d)return C([]),void w([]);var e=c.filter((function(e){return e.id===d}))[0],t=function(e){if(e){var t=e.totalTime;return{id:1,radius:J(t,1e4,14,25),depth:1,color:"rgb(51, 204, 51)"}}}(e),n=e.subtasks.map((function(e){return function(e,t){if(e){var n=e.id,a=e.subtaskName,r=e.totalTime,i=e.dependsOn,c=t===n?"rgb(255, 77, 77)":"rgb(153, 255, 153)";return{id:Number(n)+1,name:a,radius:J(r,1e4,8,20),depth:1,dependsOn:i,color:c}}}(e,O)})),a=n.map((function(e){return(t=e).dependsOn.length?t.dependsOn.map((function(e){return F(t.id,Number(e.id)+1)})):[F(t.id,1)];var t})).flatMap((function(e){return e}));C([t].concat(Object(G.a)(n))),w(a)}),[c,d,O]),r.a.createElement(Q.Provider,{value:{tasks:c,setTasks:l,activeTaskId:d,setActiveTaskId:m,activeTask:k,setActiveTask:v,activeSubtaskId:O,setActiveSubtaskId:E,nodes:j,links:S}},t)}),null,r.a.createElement((function(e){var t=e.children,n=Object(a.useState)(!1),i=Object(o.a)(n,2),c=i[0],s=i[1],u=Object(a.useState)({id:null,token:null}),d=Object(o.a)(u,2),m=d[0],b=d[1];return r.a.createElement(l.Provider,{value:{authenticated:c,setAuthenticated:s,user:m,updateUserAndLocalStorage:function(e){localStorage.setItem("token",e.token),b(e)}}},t)}),null,r.a.createElement((function(e){var t=e.children,n=Object(a.useState)(""),i=Object(o.a)(n,2),c=i[0],l=i[1],s=Object(y.a)(N.GET_TASK,{fetchPolicy:"cache-and-network"}),u=Object(o.a)(s,1)[0],d=Object(y.b)(K.DELETE_CLIENT,{onError:function(e){g(e)}}),m=Object(o.a)(d,1)[0],b=Object(y.b)(K.DELETE_TASK,{onError:function(e){g(e)}}),f=Object(o.a)(b,1)[0],k=Object(y.b)(K.DELETE_SUBTASK,{onError:function(e){g(e)}}),v=Object(o.a)(k,1)[0],g=function(e){var t=e.message,n=t.indexOf(":"),a=t.slice(n+1);l(a),X(1e3).then((function(){l("")}))};return r.a.createElement(Y.Provider,{value:{errorMessage:c,parseError:g,getTask:u,deleteClient:m,deleteTask:f,deleteSubtask:v}},t)}),null,r.a.createElement(Fe,null))))),document.getElementById("root"))},89:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d}));var a=n(41),r=n(1),i=n.n(r),c=n(28),o=n(59),l={nodes:i.a.arrayOf(i.a.shape({id:i.a.string.isRequired})).isRequired,links:i.a.arrayOf(i.a.shape({source:i.a.string.isRequired,target:i.a.string.isRequired})).isRequired,layers:i.a.arrayOf(i.a.oneOfType([i.a.oneOf(["links","nodes"]),i.a.func])).isRequired,linkDistance:i.a.oneOfType([i.a.string,i.a.func,i.a.number]).isRequired,repulsivity:i.a.number.isRequired,distanceMin:i.a.number.isRequired,distanceMax:i.a.number.isRequired,iterations:i.a.number.isRequired,nodeColor:i.a.oneOfType([i.a.string,i.a.func]).isRequired,nodeBorderWidth:i.a.oneOfType([i.a.number,i.a.func]).isRequired,nodeBorderColor:o.a.isRequired,linkThickness:i.a.oneOfType([i.a.number,i.a.func]).isRequired,linkColor:o.a.isRequired,isInteractive:i.a.bool.isRequired},s=(Object(a.a)({},l,{},c.c),Object(a.a)({pixelRatio:i.a.number.isRequired},l),{layers:["links","nodes"],linkDistance:30,repulsivity:10,distanceMin:1,distanceMax:1/0,iterations:90,nodeBorderWidth:0,nodeBorderColor:{from:"color"},linkThickness:1,linkColor:{from:"source.color"},isInteractive:!0}),u=Object(a.a)({},s,{animate:!0,motionStiffness:90,motionDamping:15}),d=Object(a.a)({},s,{pixelRatio:e.window&&e.window.devicePixelRatio?e.window.devicePixelRatio:1})}).call(this,n(79))}},[[342,1,2]]]);
//# sourceMappingURL=main.a900e101.chunk.js.map